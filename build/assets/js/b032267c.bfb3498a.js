"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[5172],{6216:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var t=r(7624),o=r(2172);const s={title:"Guidelines"},i=void 0,c={id:"WLX/WebUI Library/intro",title:"Guidelines",description:"Store state only on server",source:"@site/docs/WLX/WebUI Library/intro.md",sourceDirName:"WLX/WebUI Library",slug:"/WLX/WebUI Library/intro",permalink:"/wlx-docs/docs/WLX/WebUI Library/intro",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1708366829,formattedLastUpdatedAt:"Feb 19, 2024",frontMatter:{title:"Guidelines"},sidebar:"tutorialSidebar",previous:{title:"Todo list",permalink:"/wlx-docs/docs/WLX/examples/todolist"}},a={},l=[{value:"Store state only on server",id:"store-state-only-on-server",level:3},{value:"Use Javascript for DOM manipulations only",id:"use-javascript-for-dom-manipulations-only",level:3},{value:"Enforce server side-rendering",id:"enforce-server-side-rendering",level:3},{value:"Preparations",id:"preparations",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"store-state-only-on-server",children:"Store state only on server"}),"\n",(0,t.jsxs)(n.p,{children:["It is very hesitating to use pure JS in order to keep the slider's state or switches in the browser, even some logic of your application. However, it leads to some complicated problems to be solved such as ",(0,t.jsx)(n.em,{children:"data or state synchronization"}),", ",(0,t.jsx)(n.em,{children:"management of shared states"})," and etc for which senior React developers got paid. If everything you create does not escape the borders of your [[component]] and Wolfram Language ",(0,t.jsx)(n.strong,{children:"it will make your life easier"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"The presented framework was designed mostly for a desktop or cloud-based applications with 1-3 users (browsers tabs don't count) and a single instance of Wolfram Kernel running. Storing everything on a server comes with almost zero cost of resources."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["Even if you have a single button, use ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WebUI#%60WebUIEventListener%60",children:(0,t.jsx)(n.code,{children:"WebUIEventListener"})})," and handle its action on a server."]})}),"\n",(0,t.jsx)(n.h3,{id:"use-javascript-for-dom-manipulations-only",children:"Use Javascript for DOM manipulations only"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"or for decorative purposes"})}),"\n",(0,t.jsx)(n.p,{children:"Every action has to be approved by the server's logic. Thinking about it if you were writing a regular desktop application (using QT for example). WebSockets is no longer a bottleneck for a simple UI actions, such as typing or clicking a button."}),"\n",(0,t.jsx)(n.h3,{id:"enforce-server-side-rendering",children:"Enforce server side-rendering"}),"\n",(0,t.jsxs)(n.p,{children:["This is done automatically, since there is no client-side rendering (or hydrator like in React or Angular) tool provided. The general idea is to send a ready-to-go HTML tree including supporting Javascript code via WebSockets, similar to ",(0,t.jsx)(n.code,{children:"setInnerHTML"})," method used on a web. See ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WebUI#%60WebUILazyLoad%60",children:(0,t.jsx)(n.code,{children:"WebUILazyLoad"})}),", ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WebUI#%60WebUIContainer%60",children:(0,t.jsx)(n.code,{children:"WebUIContainer"})}),", ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WebUI#%60WebUIRefresh%60",children:(0,t.jsx)(n.code,{children:"WebUIRefresh"})})," and etc."]}),"\n",(0,t.jsx)(n.h2,{id:"preparations",children:"Preparations"}),"\n",(0,t.jsxs)(n.p,{children:["The following libraries are needed for proper functioning of ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WebUI",children:"WebUI"})," framework"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/",children:"WLX"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/Importer",children:"Importer"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WLJS",children:"WLJS"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/Misc/Events",children:"Events"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/Misc/Promise",children:"Promise"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/Misc/WLJSTransport",children:"WLJSTransport"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/Misc/Async",children:"Async"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"WebUI is a dynamic framework, which demands a live WebSocket connection. Here is a server script with comments, that provides a minimal set of libraries for a working server"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-mathematica",metastring:'title="Server.wls"',children:'#!/usr/bin/env wolframscript\n(* ::Package:: *)\nSetDirectory[If[StringQ[NotebookDirectory[] ], NotebookDirectory[], DirectoryName[$InputFileName] ] ]\n\nUncompress["1:eJx1T8tuwjAQDBT1wo0/6Ac0vveKKAoNCJoDZ5NugsXGtrwbBf6edawKLlzG+5rxzMfJ/TZvWZbRVKBomkms5wLfBmF1NcR0qN6lL/fbfMC0j4Q18\nPM80mkmcDR8TlexK0Ug7SKnAh5f9F0aRoGi8y5wVUp5Zvb0pVTQQ96KTn/qCULtLIPlvHad2kAIt0IN+Imu1uh1fdEtkOq0seoHggVUydForuJgbJsCLgSWTj7r7d/q6gMQGWfT\nLt7KLPp4ZPq3+qz0Iv6Yddcj3gGoDVPG"];\n\nPacletRepositories[{\n  Github -> "https://github.com/KirillBelovTest/Objects",\n  Github -> "https://github.com/JerryI/Internal",\n  Github -> "https://github.com/JerryI/CSocketListener" -> "dev2024",\n  Github -> "https://github.com/JerryI/TCPServer",\n  Github -> "https://github.com/JerryI/HTTPHandler",\n  Github -> "https://github.com/JerryI/WebSocketHandler",\n  Github -> "https://github.com/JerryI/wl-misc" -> "dev",\n  Github -> "https://github.com/JerryI/wl-wljs-packages",\n  Github -> "https://github.com/JerryI/wl-wlx"\n}]\n\nRandomWord[];\n\n(* Here you can configure *)\nENV = <|\n    "WSPort"   -> 8011,\n    "HTTPPort" -> 8010,\n    "Host"     -> "127.0.0.1"\n|>\n\nENV["HAddr"] := StringTemplate["``:``"][ENV["Host"], ENV["HTTPPort"]]\nENV["WAddr"] := StringTemplate["``:``"][ENV["Host"], ENV["WSPort"]]\n\n(* TCP Server *)\n<<KirillBelov`Objects`\n<<KirillBelov`Internal`\n<<KirillBelov`CSockets`\n<<KirillBelov`TCPServer`\n\n(* HTTP services *)\n<<KirillBelov`HTTPHandler`\n<<KirillBelov`HTTPHandler`Extensions`\n\n(* WS services *)\n<<KirillBelov`WebSocketHandler`\n\n(* WLX services *)\n<<JerryI`WLX`\n<<JerryI`WLX`Importer`\n<<JerryI`WLX`WLJS`\n<<JerryI`WLX`WebUI`\n\n(* Events system and WLJS communication *)\n<<JerryI`Misc`Events`\n<<KirillBelov`CSockets`EventsExtension`\n<<JerryI`Misc`WLJS`Transport`\n<<JerryI`Misc`Async`\n\n<<JerryI`WLJSPM`\n\nWLJS`PM`Repositories[{\n  Github -> "https://github.com/JerryI/wljs-interpreter" -> "dev"\n}]\n\n(* import libs data *)\nMap[Function[path,\n    Block[{System`$RemotePackageDirectory = FileNameJoin[{"wljs_packages", FileNameSplit[path] // First}]},\n        FileNameJoin[{"wljs_packages", path}] // Get // Quiet;\n    ];\n], WLJS`PM`Includes["kernel"] ];\n\n\nPrint["Staring HTTP server..."];\n\ntcp = TCPServer[];\ntcp["CompleteHandler", "HTTP"] = HTTPPacketQ -> HTTPPacketLength;\ntcp["MessageHandler", "HTTP"] = HTTPPacketQ -> http;\n\n(* Entry Point for all requests *)\nApp = ImportComponent["App.wlx"];\n\nhttp = HTTPHandler[];\nhttp["MessageHandler", "Index"] = AssocMatchQ[<|"Method" -> "GET"|>] -> App\n\nSocketListen[CSocketOpen[ENV["HAddr"]], tcp@#&]\n\nPrint["Staring WS/HTTP server..."];\n\nwcp = TCPServer[]\nwcp["CompleteHandler", "WebSocket"] = WebSocketPacketQ -> WebSocketPacketLength\nwcp["MessageHandler", "WebSocket"]  = WebSocketPacketQ -> ws\n\n(* configure the handler for WLJS communications *)\nws = WebSocketHandler[]\nws["MessageHandler", "Evaluate"]  = Function[True] -> WLJSTransportHandler\n\nSocketListen[CSocketOpen[ENV["WAddr"]], wcp@#&, "SocketEventsHandler"->CSocketsClosingHandler]\n\nStringTemplate["open http://``"][ENV["HAddr"]] // Print;\nWhile[True, Pause[1]];\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["This section is still in development. Please see Reference ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/Reference/WLX/WebUI",children:"WebUI"}),"\nA couple of examples are available: ",(0,t.jsx)(n.a,{href:"/wlx-docs/docs/WLX/examples/todolist",children:"TodoList"})," and some in the repository folder."]})})]})}function h(e={}){const{wrapper:n}={...(0,o.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},2172:(e,n,r)=>{r.d(n,{I:()=>c,M:()=>i});var t=r(1504);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);